import warnings
warnings.filterwarnings('ignore')

'''
### [ê°ê´€ì‹] Q1. ë‚ ì§œ í¬ë§· ì½”ë“œ (í•„ìˆ˜ í¬í•¨ ë¬¸ì œ)

ë‹¤ìŒ ì¤‘ **ì›”ì˜ ì „ì²´ ì´ë¦„ (ì˜ˆ: March)** ì„ ì˜ë¯¸í•˜ëŠ” `strftime()` í¬ë§· ì½”ë“œëŠ”?
ë‹µ: A

A. `%m`

B. `%M`

C. `%B`

D. `%b`

ğŸ“Œ *íŒíŠ¸: [strftime í¬ë§· ì½”ë“œ ê²€ìƒ‰](https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes)*

---

### [ê°ê´€ì‹] Q2. `pd.to_datetime()`ì˜ ì˜µì…˜ ì´í•´

`errors='coerce'`ë¥¼ ì„¤ì •í•  ê²½ìš° ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ëŠ”ê°€?
ë‹µ: A

A. ë³€í™˜ ê°€ëŠ¥í•œ í˜•ì‹ì€ ìœ ì§€ë˜ê³ , ë¶ˆê°€ëŠ¥í•œ ê°’ì€ NaTë¡œ ë°”ë€ë‹¤

B. ë¬¸ìì—´ì´ datetime í˜•ì‹ì´ ì•„ë‹ˆë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤

C. NaN ê°’ì€ ìë™ìœ¼ë¡œ ì œê±°ëœë‹¤

D. ë³€í™˜ì´ ë¶ˆê°€ëŠ¥í•œ ê°’ì€ ì‚­ì œëœë‹¤

---

### [ê°ê´€ì‹] Q3. groupby() + transformì˜ íŠ¹ì§•

ë‹¤ìŒ ì¤‘ `.transform()` í•¨ìˆ˜ì˜ ì„¤ëª…ìœ¼ë¡œ ì•Œë§ì€ ê²ƒì€?
ë‹µ: C

A. ê·¸ë£¹ë³„ë¡œ í•˜ë‚˜ì˜ ìš”ì•½ê°’ì„ ë°˜í™˜í•œë‹¤

B. ì›ë³¸ê³¼ ë‹¤ë¥¸ í¬ê¸°ì˜ ì‹œë¦¬ì¦ˆë¥¼ ë°˜í™˜í•œë‹¤

C. ê·¸ë£¹ ë‚´ ê°œë³„ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜í•˜ë©° ì›ë³¸ê³¼ ê°™ì€ í¬ê¸°ì˜ ì‹œë¦¬ì¦ˆë¥¼ ë°˜í™˜í•œë‹¤

D. í‰ê· , í•©ê³„ë§Œ ì ìš© ê°€ëŠ¥í•˜ë‹¤

---

### [ê°ê´€ì‹] Q4. concat()ê³¼ merge() ë¹„êµ

ë‹¤ìŒ ì¤‘ `pd.concat()`ê³¼ `pd.merge()`ì˜ ì°¨ì´ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ì ì ˆí•œ ê²ƒì€?
ë‹µ: C

A. ë‘˜ ë‹¤ ê¸°ë³¸ì ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•œë‹¤

B. concatì€ key ì»¬ëŸ¼ ê¸°ì¤€ ë³‘í•©ì´ë©° mergeëŠ” axis ê¸°ì¤€ ê²°í•©ì´ë‹¤

C. concatì€ ë‹¨ìˆœ ì—°ê²°, mergeëŠ” ê³µí†µ ì»¬ëŸ¼ ê¸°ì¤€ ë³‘í•©ì´ë‹¤

D. concatì€ SQLì˜ JOIN, mergeëŠ” UNION ALLê³¼ ê°™ë‹¤

'''
# Q5.strftime()ì„ í™œìš©í•˜ì—¬ í˜„ì¬ ì‹œê°„ì„ "YYYY-MM-DD HH:MM" í˜•ì‹ ë¬¸ìì—´ë¡œ ì¶œë ¥í•˜ì„¸ìš”.
from datetime import datetime
import pandas as pd

now = datetime.now()
format_date = now.strftime("%Y-%m-%d %H:%M")
# print(format_date, type(format_date))

# Q6. ë‹¤ìŒ DataFrameì—ì„œ "2023/01/01"ì„ datetimeìœ¼ë¡œ ë³€í™˜í•˜ê³ , ì—°ë„(year) ë§Œ ì¶”ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”
df = pd.DataFrame({"date": ["2023/01/01"]})
df["date"] = pd.to_datetime(df["date"])
df["year"] = df["date"].dt.year
# print(df)

# Q7. ì•„ë˜ DataFrameì—ì„œ êµ­ì–´ ì ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ëœ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.

# Q8. ì•„ë˜ ë°ì´í„°ë¥¼ ì´ìš©í•´ ë¶€ì„œë³„ í‰ê·  ì—°ë´‰ì„ ê³„ì‚°í•˜ê³  ìƒˆë¡œìš´ ì»¬ëŸ¼ "ë¶€ì„œí‰ê· "ìœ¼ë¡œ ì›ë³¸ì— ì¶”ê°€í•˜ì„¸ìš”.

# Q9. ì•„ë˜ ë‘ DataFrameì„ ì§ì›ID ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¶€ ì¡°ì¸(inner join) í•˜ì—¬ ë³‘í•©í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.

df1 = pd.DataFrame({
    "ì§ì›ID": ["E1", "E2", "E3"],
    "ì´ë¦„": ["í™ê¸¸ë™", "ê¹€ì² ìˆ˜", "ì´ì˜í¬"]
})

df2 = pd.DataFrame({
    "ì§ì›ID": ["E2", "E3", "E4"],
    "ë¶€ì„œ": ["íšŒê³„íŒ€", "ì˜ì—…íŒ€", "ê°œë°œíŒ€"]
})

df_inner = pd.merge(df1, df2, on="ì§ì›ID", how="inner")
# print(df_inner)

# ë¹…ë¶„ê¸° ê¸°ì¶œ ë¬¸ì œ 
'''
Q1.
í•™êµ ì„¸ë¶€ìœ í˜•ì´ ì¼ë°˜ì¤‘í•™êµì¸ í•™êµë“¤ ì¤‘
ì¼ë°˜ì¤‘í•™êµ ìˆ«ìê°€ 2ë²ˆì§¸ë¡œ ë§ì€ ì‹œë„ì˜ ì¼ë°˜ì¤‘í•™êµ ë°ì´í„°ë§Œ
í•„í„°í•˜ì—¬ í•´ë‹¹ ì‹œë„ì˜ êµì› í•œëª… ë‹¹ ë§¡ì€
í•™ìƒìˆ˜ê°€ ê°€ì¥ ë§ì€ í•™êµë¥¼ ì°¾ì•„ì„œ í•´ë‹¹ í•™êµì˜ êµì›ìˆ˜ë¥¼ ì¶œë ¥í•˜ë¼
'''
df3 = pd.read_csv('https://raw.githubusercontent.com/Datamanim/datarepo/main/krdatacertificate/e6_p1_2.csv')
# sprint(df3.head(5))

# step1 ì„¸ë¶€ìœ í˜• ì¼ë°˜ì¤‘í•™êµ ì¤‘ ìˆ«ìê°€ 2ë²ˆì§¸ë¡œ ë§ì€ ì‹œë„ í•„í„°
filter = df3[df3['í•™êµì„¸ë¶€ìœ í˜•'] == 'ì¼ë°˜ì¤‘í•™êµ']
df3_count = filter['ì‹œë„'].value_counts()
second_sido = df3_count.index[1]
# print(second_sido) # ì‹œë„ í™•ì¸
step1_result = filter[filter['ì‹œë„'] == second_sido]
# print(step1_result.head(5))

# step2 í•„í„°ëœ ë°ì´í„°í”„ë ˆì„ì—ì„œ êµì› í•œëª… ë‹¹ ë§¡ì€ í•™ìƒìˆ˜ê°€ ê°€ì¥ ë§ì€ í•™êµì˜ êµì›ìˆ˜ í•„í„°ë§
step1_result['êµì›ë‹¹_í•™ìƒ'] = step1_result['ì¼ë°˜í•™ê¸‰_í•™ìƒìˆ˜_ê³„'] / step1_result['êµì›ìˆ˜_ì´ê³„_ê³„']
# print(step1_result.head(5))
st2_sorted = step1_result.sort_values(by="êµì›ë‹¹_í•™ìƒ", ascending=False)
# print(st2_sorted.head(3))
step2_result = st2_sorted.iloc[0]['êµì›ìˆ˜_ì´ê³„_ê³„']
# print(step2_result)

'''
Q2.
5ëŒ€ ë²”ì£„(ì ˆë„, ì‚¬ê¸°, ë°°ì„, ë°©í™”, í­í–‰)ì˜ ì›”ë³„ ì´ ë°œìƒê±´ìˆ˜ë¥¼
ì´ë²”ì£„ìˆ˜ë¼ê³  í‘œí˜„í•˜ì. 18,19ë…„ì˜ ê°ê° ë¶„ê¸°ë³„ ì´ë²”ì£„ìˆ˜ì˜
ì›”í‰ê·  ê°’ì„ êµ¬í–ˆì„ë•Œ ìµœëŒ€ê°’ì„ ê°€ì§€ëŠ” ë…„ë„ì™€ ë¶„ê¸°ë¥¼ êµ¬í•˜ê³ 
í•´ë‹¹ ë¶„ê¸°ì˜ ìµœëŒ“ê°’ì˜ ì‚¬ê¸°ê°€ ë°œìƒí•œ ì›”ì˜ ì‚¬ê¸° ë°œìƒê±´ìˆ˜ë¥¼
ì¶œë ¥í•˜ë¼
(1ë¶„ê¸°:1,2,3ì›” / 2ë¶„ê¸° : 4,5,6ì›” /
 3ë¶„ê¸° 7,8,9ì›” / 4ë¶„ê¸° 10,11,12ì›” ,
 1ë¶„ê¸° ì›”í‰ê·  : 1,2,3ì›”ì˜ ì´ë²”ì£„ìˆ˜ í‰ê· )
'''
# step1 ì´ë²”ì£„ìˆ˜ ì»¬ëŸ¼ ì¶”ê°€ í›„ 18,19ë…„ë„ ê°ê° ë¶„ê¸°ë³„ ì´ë²”ì£„ìˆ˜ ì›”í‰ê·  ê°’
df2 = pd.read_csv('https://raw.githubusercontent.com/Datamanim/datarepo/main/krdatacertificate/e6_p1_3.csv')
# ë”í•  ì—´ ì§€ì •í•˜ê¸°
columns_sum = ['ì ˆë„', 'ì‚¬ê¸°', 'ë°°ì„', 'ë°©í™”', 'í­í–‰']
# í–‰ ë³„ë¡œ ì´í•© 'ì´ë²”ì£„ìˆ˜' ì»¬ëŸ¼ ì¶”ê°€
df2['ì´ë²”ì£„ìˆ˜'] = df2[columns_sum].sum(axis=1)
# print(df2.head(3))
df2[['ë…„ë„', 'ì›”']] = df2['ë²”ì£„ë¶„ë¥˜'].str.split('_', expand=True)

# ìˆ«ì ë³€í™˜
df2['ë…„ë„'] = df2['ë…„ë„'].str.replace('ë…„', '').astype(int)
df2['ì›”'] = df2['ì›”'].str.replace('ì›”', '').astype(int)

# ë¶„ê¸°ë¥¼ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜ ìƒì„±
def get_quarter(month):
  if month in [1,2,3]:
    return '1ë¶„ê¸°'
  elif month in [4, 5, 6]:
    return '2ë¶„ê¸°'
  elif month in [7, 8, 9]:
    return '3ë¶„ê¸°'
  else:
    return '4ë¶„ê¸°'

df['ë¶„ê¸°'] = df2['ì›”'].apply(get_quarter)

s = "ì‚¬ê³¼,ë°°,í¬ë„,ê·¤"
result = s.split(',', maxsplit=3)
print(result)